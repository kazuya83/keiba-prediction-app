# 実行計画 18: 自動テストスイート・CI統合

## ゴール
- バックエンド/フロント/ML/インフラのテストを自動化し、CIで常に検証できる状態にする。

## 手順
1. バックエンドに `pytest` 用カバレッジ設定（`pytest.ini`）を追加し、主要モジュールのテストケースを作成。
2. フロントエンドに `React Testing Library` + `Jest` を導入し、認証フォームやページコンポーネントの単体テストを追加。
3. PlaywrightでE2Eテストプロジェクトを作成し、主要ユーザーフロー（ログイン→レース選択→予測実行→履歴確認）をスクリプト化。
4. MLパイプライン向けに `pytest` を用いたデータ品質テストとモデル評価テスト（閾値チェック）を実装。
5. GitHub Actions（または選定CI）にワークフローを追加し、`lint` → `test-backend` → `test-frontend` → `test-ml` → `playwright` を並列/逐次で実行。
6. CIの結果をSlackや通知API（計画10）に連携し、失敗時にアラートを送信。
7. カバレッジレポート（Codecov等）を導入し、閾値（例: 80%）を設定。閾値未達時はCIを失敗させる。

## 成果物
- テストコード群（backend, frontend, ml, e2e）とCIワークフロー。
- カバレッジバッジやレポートURL。
- CI失敗時に通知される仕組み。

## 依存・前提
- 計画02〜17で機能が実装され、テスト対象が存在。
- CI環境で必要な依存（Docker、ブラウザ、DB）が利用可能。

## リスクと対策
- **リスク**: PlaywrightがCIで不安定。  
  **対策**: Retries設定、`--headed` モードでスクリーンショット・動画保存。
- **リスク**: テスト時間の増加。  
  **対策**: ジョブをマトリクスで分割し、キャッシュを活用。

